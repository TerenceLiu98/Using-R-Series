---
title: "Assignment 3"
author: "Terry Liu"
output:
  word_document: default
  html_document: default
  pdf_document: default
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## Question One

The datat file **Real-Estate.txt** contains information on the homes sold in the Denver area during the yea 2003. The variables in this data file are as follows: 

| Name | Representation |
| ---- | ------------ |
|Price|Selling price in $1000|
|Bedrooms|Number of bedrooms|
|Size|Size of the home in square feet|
|Pool|Swimming Pool(1=Yes,0=No)
|Distance|Distance from the home to the center of the city|
|Township|Township NO.|
|Garage|Garage attached(1=Yes,0=No)|
|Baths|Number of bathrooms|

### Part A
Give a plot of selling price agaignst distance from the home to the center of the city. Does there seem to be a relationship between the two variables? If so, is the relationship direct or inverse ? 

### Answer: 
```{r}
data1 <- read.table("Real-Estate.txt",header=TRUE)
names(data1)

x <- data1$Distance
y <- data1$Price

plot(x,y)
abline(lm(y~x))
```
We can have the conclusion that there is negative relationship between distance and the selling prze.

### Part B

Plot a histogram for selling price. Comment on the shape of the distribution. 
```{r}
hist.default(data1$Price,xlim=c(50,400),main='Price')

skewness <- function (x, na.rm = FALSE) 

{

  if (na.rm) 

    x <- x[!is.na(x)]

  sum((x - mean(x))^3)/(length(x) * sd(x)^3)

}


skewness(data1$Price)

```
We can get the skewness of these data (Selling Price) is equals to $0.4605562$, so, it is Positive Skew. 

### Part C 

Create a side-by-side box plots to compare the distribution of selling price for homes with an attached garage and homes without a garage. Comment on what you observe.

```{r}
x_1 <- data1$Price[data1$Garage==1]
x_2 <- data1$Price[data1$Garage==0]
Garage <- c("with Garage","without Garage")
boxplot(x_1,x_2,names = Garage, horizontal = TRUE, main = "The Price comparison",xlab="Price")
```
Observation: The averge price of those have garage are higher than without garage.

### Part D 

There are five Townships in htis data. Draw a bar plot to compare the number of homes sold in these Townships. 

```{r}
township_1 <- length(data1$Township[data1$Township == 1])
township_2 <- length(data1$Township[data1$Township == 2])
township_3 <- length(data1$Township[data1$Township == 3])
township_4 <- length(data1$Township[data1$Township == 4])
township_5 <- length(data1$Township[data1$Township == 5])

name_township <- c("township1", "township2", "township3", "township4", "township5")
township <- c(township_1, township_2, township_3 ,township_4, township_5)
tmp <- as.vector(name_township)  

bar <- barplot(township, axes=T, names = name_township, las=2)
```

### Part E 

Draw a pie chart of the varialbe "Baths" and label the percentage of each number of Bathrooms 

```{r}
x <- c(unique(data1$Baths))

length_x <- length(x)



lbls <- x
pct <- round(x/sum(x)*100)
lbls <- paste(lbls, pct) # add percents to labels 
lbls <- paste("Baths=",lbls,"%",sep="") # ad % to labels 
pie(x,labels = lbls, col=rainbow(length(lbls)),
  	main="Pie Chart of Baths")

```

## Question Two

Recently, it has been proposed that there is a non-linear relation between the number of perople $N$ in a city, and its economic output per person $Y$ (per captia \gross metropolitan product): 
$$Y = y_0N^a + \text{ noise }$$


Using data from the 366 metropolitan area of the US (as of 2006) to estimate $a$, by minimizing the mean squared error,
$$\frac{1}{366} \sum_{i=1}^366 (Y_i - y_0N_i^a)^2$$
over all a. We will ess later in the class how we could estimate both parameters at onece, but for now we'll treat $y_0$ as know, and in particular equal = $6611$.

### Part A 
Using the read.table command, load the gmp.dat (on Ispace) into a data frame called gmp. 

```{r}
data2 <- read.table('gmp.dat',header=T)

data2 
```

#### Part B 
The last two columns give, for each city, the total gross metropolitan product ($YN$) and the per-capita metropolitan product ($Y$). Use this to make a vector which has the population ($N$) for each city. 
```{r}

y_0 <- 3611
y_i <- as.vector(data2$pcgmp)
yN_i <- as.vector(data2$gmp)

N_i <- yN_i /y_i

N_i <- as.vector(N_i)

```

#### Part C 

Add the vector of populations to the gmp data fram as a new column, named pop.

```{r}
data2$pop <- N_i

names(data2)
```

#### Part D 

Calcluate the mean squared error (MSE) of the power-law model, when $y_0 = 6611$ (in dollars) and $a = 0.15$ 

```{r}
y_0 <- 3611
a <- 0.15

MSE <- 1 / 366* sum((y_i - y_0 * N_i ^ a) ^ 2) 
MSE <- sprintf("%.2f",MSE)

paste("The MSE equals",MSE)
```

#### Part E 

Make a sequence of values of a, from $0.10$ to $0.15$, in steps of $0.005$. Calculate the MSE for each value of $a$ in that sequence, and store all the MSEs in a vector.

```{r}
a_seq <- seq(0.1, 0.15, by=0.005)
MSE_seq <- NULL

for (i in 1:length(a_seq)){
  MSE_seq[i] <- 1 / 366* sum((y_i - y_0 * N_i ^ a_seq[i]) ^ 2)
}
print(MSE_seq)
```

#### Part F 

Plot the square roots of the MSEs vs. a. What are the units of the root mean squared error? What value of a, among those you looked at, leads to the least squared error? 
```{r}
plot(MSE_seq,a_seq)
```

### Question Three 

Using `R` to answer the following questions:

#### Part A

For normal distribution $N(0,1)$, find a number $z^*$ such that $p(-z^* < Z < z^*) = 0.05$ 
```{r}
x <- seq(-10,10,by=0.0001)
norm_x <- pnorm(x,mean = 0, sd = 1)
norm_x_inverse <- pnorm(-x, mean = 0, sd = 1)

y <- abs(norm_x - norm_x_inverse)

for( i in 1:length(y)){
  if(y[i] == 0.05){
    print(x[i])
  }
}
```


#### Part B 

How much area (probability) is to the right of $1.5$ for a normal distribution $N(0,2)$ ?

```{r}
1 - pnorm(1.2,mean = 0, sd = 2)
```

### Question Four

 Calculate the probability for each of the following events:                                   
#### Part A

A normally distributed variable with mean $35$ and standard deviation $6$ is larger than $42$. 

```{r}
1 - pnorm(42, mean = 35, sd = 6)
```

Getting $7$ out of $10$ successes in a binomial distribution with probability $0.8$.

```{r}
choose(10,7) * 0.8 ^ 7 * 0.2 ^ 3
```

### Question Five 

Three fair dice are rolled, and all outcomes are equally likely. Write a simulation program using `R` to estimate the probability that the sum of all the numbers on the dice is at least $10$. 

```{r}
 dice <- function(x){
  time1 <- Sys.time()
  dice_1 <- sample(1:6, x, replace=T)
  dice_2 <- sample(1:6, x, replace=T)
  dice_3 <- sample(1:6, x, replace=T)
  dice_total <- dice_1 + dice_2 + dice_3 
  SUM_10 <- dice_total[dice_total >= 10]
  PRO <- length(SUM_10) / length(dice_total)
  time2 <- Sys.time()
  time_t <- time2 - time1
  print(time_t)
  return(PRO)
  
 }

# function test
dice(10)
```

### Question Six

The file Esti.txt in Ispace contains a set of data which consists of $3000$ observations. 

#### Part A

Make a histogram for the data. Which distribution would be a plausible model?
```{r}
data3 <- read.table("Esti.txt", header = FALSE)

data3 <- as.numeric(data3)
hist(data3)
```
According to the histogram, I think Exponential distribution model would be a plausible model.


#### Part B

Suppose that the exponential distribution would be used to fit the data. Use R to fit the parameters by the method of moments and maximum likelihood. 

```{r}
lambda <- 1 / mean(data3)

# Using the method of moments
uniroot(data3,))
```
#### Part C

Suppose that the gamma distribution is also used to fit the data. Use R to fit the parameters by the method of moments.

#### Part D

Compare the two estimates obtained by (2) and (3). Which estimation is better?  






























